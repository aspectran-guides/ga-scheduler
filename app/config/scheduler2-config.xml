<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE aspectran PUBLIC "-//ASPECTRAN//DTD Aspectran Configuration 6.0//EN"
        "http://aspectran.github.io/dtd/aspectran-6.dtd">
<aspectran>

    <description>
        An Aspectran Configuration that prints out the current time
        every five seconds using Aspectran Scheduler
    </description>

    <settings>
        <setting name="transletNamePattern" value="*.job"/>
    </settings>

    <bean id="schedulerFactory" class="org.quartz.impl.StdSchedulerFactory">
        <constructor>
            <arguments>
                <item type="properties">
                    <value name="org.quartz.scheduler.instanceName">AspectranQuartzScheduler-2</value>
                    <value name="org.quartz.scheduler.rmi.export">false</value>
                    <value name="org.quartz.scheduler.rmi.proxy">false</value>
                    <value name="org.quartz.scheduler.wrapJobExecutionInUserTransaction">false</value>
                    <value name="org.quartz.threadPool.class">org.quartz.simpl.SimpleThreadPool</value>
                    <value name="org.quartz.threadPool.threadCount">10</value>
                    <value name="org.quartz.threadPool.threadPriority">5</value>
                    <value name="org.quartz.threadPool.threadsInheritContextClassLoaderOfInitializingThread">true</value>
                    <value name="org.quartz.jobStore.misfireThreshold">60000</value>
                    <value name="org.quartz.jobStore.class">org.quartz.simpl.RAMJobStore</value>
                </item>
            </arguments>
        </constructor>
    </bean>

    <bean id="scheduler2" factoryBean="schedulerFactory" factoryMethod="getScheduler"/>

    <schedule id="schedule2">
        <scheduler bean="scheduler2">
            <trigger type="simple">
                startDelaySeconds: 2
                intervalInSeconds: 5
                repeatCount: 0
            </trigger>
        </scheduler>
        <job translet="sample01" method="POST"/>
        <job translet="sample02"/>
    </schedule>

    <translet name="sample02">
        <action bean="scheduledTasks" method="reportCurrentTime"/>
        <transform type="transform/text">
            <template style="apon">
                |[schedule2-sample02-@{count}] @{msg}
            </template>
        </transform>
    </translet>


</aspectran>